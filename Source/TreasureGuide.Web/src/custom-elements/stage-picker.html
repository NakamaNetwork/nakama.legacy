<template>
    <ux-dialog>
        <ux-dialog-header>
            <div class="_floatRight">
                <a click.delegate="cancel()" class="button _flat modal-action">X</a>
            </div>
            <h3>Select a Stage</h3>
        </ux-dialog-header>
        <ux-dialog-body>
            <div class="row">
                <form with.bind="searchModel">
                    <div class="col m4">
                        <label for="termInput">Term</label>
                        <input id="termInput" type="text" value.two-way="term" />
                    </div>
                    <div class="col m4">
                        <label for="checkInput">
                            <input type="checkbox" checked.two-way="global" />
                            Global
                        </label>
                    </div>
                    <div class="col m4">
                        <label for="typeInput">Type</label>
                        <input id="typeInput" type="number" value.two-way="type" />
                    </div>
                </form>
            </div>
            <div class="row center" if.bind="pages > 1">
                <md-pagination md-pages.bind="pages" md-active-page.bind="searchModel.page" md-on-page-changed.delegate="onPageChanged($event)"></md-pagination>
            </div>
            <div class="row">
                <div class="center" if.bind="stages.length > 0">
                    <p>${((searchModel.page - 1) * searchModel.pageSize) +1} - ${((searchModel.page - 1) * searchModel.pageSize) + stages.length} of ${resultCount}</p>
                </div>
                <table class="_width100">
                    <thead>
                        <tr>
                            <th>Stage</th>
                            <th>Type</th>
                            <th>Global</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr click.delegate="clicked(null)" class="${(!stageId ? 'active' : '')}">
                            <td>Any</td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr repeat.for="stage of stages" click.delegate="clicked(stage.id)" class="${(stageId === stage.id ? 'active' : '')}">
                            <td>${stage.name}</td>
                            <td><stage-type-display type.bind="stage.type" /></td>
                            <td><global-display global.bind="stage.global" /></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="row center" if.bind="!stages || stages.length == 0">
                <h3>Search yielded no results!</h3>
            </div>
        </ux-dialog-body>
        <ux-dialog-footer>
            <a click.delegate="cancel()" class="button modal-action">Cancel</a>
        </ux-dialog-footer>
    </ux-dialog>
</template>
